/*
 *  jQuery autocomplete address - v1.0.0
 *  A jQuery plugin to autocomplete address using the correio's CEP
 *  https://github.com/arthurfigueiredo/autocomplete-address
 *
 *  Made by Arthur Figueiredo
 */
!function(a,b,c,d){function e(b,c){this.element=b,this.settings=a.extend({},g,c),this._defaults=g,this._name=f,this.init()}var f="autocompleteAddress",g={publicAPI:"https://viacep.com.br/ws/{{cep}}/json/",address:"",neighborhood:"",city:"",state:"",setReadonly:!0};a.extend(e.prototype,{init:function(){self=this,$cep=a(this.element),$address=this.getData("autocomplete-address"),$neighborhood=this.getData("autocomplete-neighborhood"),$city=this.getData("autocomplete-city"),$state=this.getData("autocomplete-state"),currentCep=$cep.val(),$cep.mask&&$cep.mask("99999-999"),$cep.on("blur change keyup",function(){var a=$cep.val();a=a.replace(/\-|\./g,""),a&&currentCep!==a&&8===a.length&&(currentCep=a,self.sendRequest())})},getData:function(b){var c=a(this.settings[b.replace("autocomplete-","")]);return 0===c.length&&(c=a("."+b),0===c.length&&(c=a("[data-"+b+"]"))),c},sendRequest:function(){var b=currentCep.replace("-","");a.ajax({url:this.settings.publicAPI.replace("{{cep}}",b),type:"GET",dataType:"json",success:function(a){self.bindValues(a)}})},bindValues:function(a){$address.val(a.logradouro),$neighborhood.val(a.bairro),$state.is("select")?($state.children('option:contains("'+a.uf+'")').prop("selected",!0),$state.next().hasClass("nice-select")&&$state.niceSelect("update")):$state.val(a.uf),$state.change(),$city.is("select")?($city.children('option:contains("'+a.localidade+'")').prop("selected",!0),$city.data("select",a.localidade)):$city.val(a.localidade),$city.change(),this.settings.setReadonly&&this.checkStatusField([$address,$neighborhood,$city,$state])},checkStatusField:function(b){for(var c,d,e=b.length;e--;)c=a(b[e]),d=c.val(),b[e].length>0&&d&&d.match(/[a-z]/i)?c.addClass("disabled").prop("readonly",!0):c.removeClass("disabled").prop("readonly",!1)}}),a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))}),this}}(jQuery,window,document);